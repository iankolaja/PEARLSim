set_max_passes 8
set_seed 42
core_geometry "gFHR_template.serpent"
triso_file 400 gFHR_triso.dat
# load_pebble_model ml_models/current_rfr.pkl ml_models/burnup_rfr.pkl
# load_velocity_profile gFHR_velocity_profile.dat
fresh fuel20 materials/fuel20.dat graphpeb materials/graphpeb.dat
static_fuel_materials SiC materials/SiC_gFHR.dat PyC materials/PyC_gFHR.dat buffer materials/buffer_gFHR.dat matrix materials/matrix_gFHR.dat
define_zones gFHR_zones.inp gFHR_points.dat

set seed 42
set acelib "/global/home/groups/co_nuclear/serpent/xsdata/endfb7/sss_endfb7u.xsdata" "/global/home/groups/co_nuclear/serpent_photon_data/mcplib.xsdata"
set declib "/global/home/groups/co_nuclear/serpent/xsdata/endfb7/sss_endfb7.dec"
set pdatadir "/global/home/groups/co_nuclear/serpent_photon_data/photon_data"
set nfylib "/global/home/groups/co_nuclear/serpent/xsdata/endfb7/sss_endfb7.nfy"
set opti 2
set gcu -1
set memfrac 0.99
set repro 0
set shbuf 0 0
set outp 100000
set nbuf 1000
set depout 3 1
set ures 1
set inventory all
set printm 1 1.0E-41
set fpcut 0

initialize 100 graphpeb 1
burn_time 6.525
power 280e6

# Set up initial core with 43 percent graphite pebbles and 8 passes present
insertion 11 off 0 graphpeb 0.875 reinsert 1.0 fuel20 1.0
insertion 11 off 0 graphpeb 0.750 reinsert 1.0 fuel20 1.0
insertion 11 off 0 graphpeb 0.625 reinsert 1.0 fuel20 1.0
insertion 11 off 0 graphpeb 0.500 reinsert 1.0 fuel20 1.0
insertion 11 off 0 graphpeb 0.375 reinsert 1.0 fuel20 1.0
insertion 11 off 0 graphpeb 0.250 reinsert 1.0 fuel20 1.0
insertion 11 off 0 graphpeb 0.125 reinsert 1.0 fuel20 1.0
insertion 11 off 0 graphpeb 0.000 reinsert 1.0 fuel20 1.0

# Begin serpent runs here!
set power 280e6
set opti 2
set pop 10000 35 15
insertion 200 off 2 graphpeb 0.000 reinsert 1.0 fuel20 1.0

# Drop down to 90 percent power
set power 252e6
insertion 200 off 2 graphpeb 0.000 reinsert 1.0 fuel20 1.0

# Drop down to 50 percent power for a little bit
set power 140e6
insertion 50 off 2 graphpeb 0.000 reinsert 1.0 fuel20 1.0

# Return to full power
set power 280e6
insertion 200 off 2 graphpeb 0.000 reinsert 1.0 fuel20 1.0

# Increase to 110 percent power
set power 308e6
insertion 200 off 2 graphpeb 0.000 reinsert 1.0 fuel20 1.0

# Increase to 125 percent power
set power 350e6
insertion 50 off 2 graphpeb 0.000 reinsert 1.0 fuel20 1.0

# Return to full power for some time
set power 280e6
insertion 100 off 2 graphpeb 0.000 reinsert 1.0 fuel20 1.0

# Suddenly drop to 50 percent power
set power 140e6
insertion 80 off 2 graphpeb 0.000 reinsert 1.0 fuel20 1.0

# Quickly rise to 60
set power 168e6
insertion 30 off 1 graphpeb 0.000 reinsert 1.0 fuel20 1.0

# Quickly rise to 70
set power 196e6
insertion 30 off 1 graphpeb 0.000 reinsert 1.0 fuel20 1.0

# Quickly rise to 80
set power 224e6
insertion 30 off 1 graphpeb 0.000 reinsert 1.0 fuel20 1.0

# Quickly rise to 90
set power 252e6
insertion 30 off 1 graphpeb 0.000 reinsert 1.0 fuel20 1.0

# Return to full power
set power 280e6
insertion 60 off 1 graphpeb 0.000 reinsert 1.0 fuel20 1.0

# Increase to 125 percent power for a few days! Ahh!
set power 350e6
insertion 10 off 1 graphpeb 0.000 reinsert 1.0 fuel20 1.0

# Everything is fine
set power 280e6
insertion 40 off 1 graphpeb 0.000 reinsert 1.0 fuel20 1.0

# Suddenly drop to 50 percent power bc some idiot dropped the control rods
set power 140e6
insertion 10 off 1 graphpeb 0.000 reinsert 1.0 fuel20 1.0

# Everything is fine
set power 280e6
insertion 40 off 1 graphpeb 0.000 reinsert 1.0 fuel20 1.0

save
