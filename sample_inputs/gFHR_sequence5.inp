set_seed 42
set_averaging_mode burnup
set_threshold 17.0
core_geometry "gFHR_template.serpent"
triso_file 800 gFHR_triso.dat
# load_pebble_model ml_models/current_rfr.pkl ml_models/burnup_rfr.pkl
# load_velocity_profile gFHR_velocity_profile.dat
fresh fuel20 materials/fuel20.dat graphpeb materials/graphpeb.dat
static_fuel_materials SiC materials/SiC_gFHR.dat PyC materials/PyC_gFHR.dat buffer materials/buffer_gFHR.dat matrix materials/matrix_gFHR.dat
define_zones gFHR_zones.inp gFHR_points.dat

set seed 42
set acelib "/global/home/groups/co_nuclear/serpent/xsdata/endfb7/sss_endfb7u.xsdata" "/global/home/groups/co_nuclear/serpent_photon_data/mcplib.xsdata"
set declib "/global/home/groups/co_nuclear/serpent/xsdata/endfb7/sss_endfb7.dec"
set pdatadir "/global/home/groups/co_nuclear/serpent_photon_data/photon_data"
set nfylib "/global/home/groups/co_nuclear/serpent/xsdata/endfb7/sss_endfb7.nfy"
set opti 2
set gcu -1
set memfrac 0.99
set repro 0
set shbuf 0 0
set outp 100000
set nbuf 1000
set depout 3 1
set ures 1
set inventory all
set printm 1 1.0E-41
set fpcut 0
set xenon 1

initialize 100 graphpeb 1

# Begin serpent runs here!
set opti 2
set pop 24000 30 10

debug_level 2

set_discharge_threshold 18.63
set_threshold_rel_std 0.02288
set_burnup_time_step 6.525
set_power 280e6
set_rod_depth 369.47


# Quick ramp up to equilibrium

insertion 9 off 0 graphpeb 0.0 reinsert 1.0 fuel20 1.0
set_num_fuel_groups 4
insertion 11 off 2 graphpeb 0.0 reinsert 1.0 fuel20 1.0

set_substep_schema 0.25 0.75
set_num_fuel_groups 8

insertion 20 off 2 graphpeb 0.0 reinsert 1.0 fuel20 1.0

set_num_fuel_groups 12

insertion 150 off 2 graphpeb 0.0 reinsert 1.0 fuel20 1.0


# Begin single variable change sequence

# Drop down to 90 percent power
set_power 252e6
insertion 10 off 2 graphpeb 0.00 reinsert 1.0 fuel20 1.0

# Drop down to 50 percent power for a little bit
set_power 140e6
insertion 5 off 2 graphpeb 0.00 reinsert 1.0 fuel20 1.0

# Return to full power
set_power 280e6
insertion 10 off 2 graphpeb 0.00 reinsert 1.0 fuel20 1.0


# Increase to 105 percent power
set_power 294e6
insertion 5 off 2 graphpeb 0.00 reinsert 1.0 fuel20 1.0

# Increase to 110 percent power for a bit
set_power 308e6
insertion 5 off 2 graphpeb 0.00 reinsert 1.0 fuel20 1.0

# Return to normal power
set_power 280e6
insertion 10 off 2 graphpeb 0.00 reinsert 1.0 fuel20 1.0


# Raise threshold
set_discharge_threshold 20.63

insertion 10 off 2 graphpeb 0.00 reinsert 1.0 fuel20 1.0

# Return threshold
set_discharge_threshold 18.63
insertion 10 off 2 graphpeb 0.00 reinsert 1.0 fuel20 1.0

# Lower threshold
set_discharge_threshold 16.63
insertion 10 off 2 graphpeb 0.00 reinsert 1.0 fuel20 1.0

# Return threshold
set_discharge_threshold 18.63
insertion 10 off 2 graphpeb 0.00 reinsert 1.0 fuel20 1.0


# Begin two variable change sequence

# Drop down to 80 percent power and higher threshold
set_power 224e6
set_discharge_threshold 19.63
insertion 10 off 2 graphpeb 0.00 reinsert 1.0 fuel20 1.0

# Return to normal
set_discharge_threshold 18.63
insertion 10 off 2 graphpeb 0.00 reinsert 1.0 fuel20 1.0

# Drop down to 105 percent power and lower threshold
set_power 294e6
set_discharge_threshold 17.63
insertion 10 off 2 graphpeb 0.00 reinsert 1.0 fuel20 1.0

# Return to normal
set_power 280e6
set_discharge_threshold 18.63
insertion 10 off 2 graphpeb 0.00 reinsert 1.0 fuel20 1.0

# Hard sequence

# Drop down to 50 percent power for a little bit
set_power 140e6
insertion 10 off 2 graphpeb 0.00 reinsert 1.0 fuel20 1.0

# Lower threshold and start ramping up power

set_discharge_threshold 17.63

set_power 168e6
insertion 5 off 2 graphpeb 0.00 reinsert 1.0 fuel20 1.0

set_power 196e6
insertion 5 off 2 graphpeb 0.00 reinsert 1.0 fuel20 1.0

set_power 224e6
insertion 5 off 2 graphpeb 0.00 reinsert 1.0 fuel20 1.0

set_power 252e6
insertion 5 off 2 graphpeb 0.00 reinsert 1.0 fuel20 1.0

set_power 280e6
insertion 5 off 2 graphpeb 0.00 reinsert 1.0 fuel20 1.0

# Power peak
# 125 power briefly
set_power 350e6
insertion 3 off 2 graphpeb 0.00 reinsert 1.0 fuel20 1.0

# 110 power and higher threshold
set_discharge_threshold 20.63
set_power 308e6
insertion 5 off 2 graphpeb 0.00 reinsert 1.0 fuel20 1.0

# 90 percent power for a while with new threshold
set_power 252e6
insertion 10 off 2 graphpeb 0.00 reinsert 1.0 fuel20 1.0




save
